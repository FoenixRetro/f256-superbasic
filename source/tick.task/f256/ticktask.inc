; ************************************************************************************************
; ************************************************************************************************
;
;		Name:		ticktask.inc
;		Purpose:	Macros for tick-tasks
;		Created:	21st November 2022
;		Reviewed: 	No.
;		Author : 	Paul Robson (paul@robsons.org.uk)
;
; ************************************************************************************************
; ************************************************************************************************

		.if 	HARDWARE==0

; ************************************************************************************************
;
;								This Macro initialises the tick timer
;
; ************************************************************************************************

tickinitialise 	.macro
		.endm		

; ************************************************************************************************
;
;		Called 1 in every 8 instructions, firing if more than 3 clocks (e.g 0.05 seconds approx) 
; 		has elapsed.
;
; ************************************************************************************************

tickcheck		.macro
		stz 	1 							; access I/O Page 0
		sec 								; calculate timer - LastTick
		lda 	$D659
		tax 								; saving timer in X
		sbc 	LastTick
		cmp 	#3
		bcc 	_NoFireTick 				; if < 3 clocks don't fire.
		stx 	LastTick 					; update last timer
		jsr 	\1 							; go do the code.
_NoFireTick:		
		.endm

		.endif

; ************************************************************************************************
;
;									Changes and Updates
;
; ************************************************************************************************
;
;		Date			Notes
;		==== 			=====
;
; ************************************************************************************************
